parameters:
  - name: secretNames
    type: object
    default: 
     - REPLACEME

steps:

  - powershell: |
      $secretArr=@();
      $envs = Get-ChildItem env:* | sort-object name
      Foreach ($env in $envs) { 
        $name=$env.Name 
        $value=$env.Value
          Write-Host "looking: $name = $value"
        if ($name -like "tf_secret_*"){
          Write-Host "adding: $name"
          Write-Host ""
          echo "##vso[task.setvariable variable=$name;isOutput=true]$value"
        }
      }
      $setthis=$env:tf_secret_gov_uk_notify_api_testing_key
      Write-Host "set $setthis"
    name: setSecretVars
    displayName: Set Secret Variables
    env:
      ${{ each name in parameters.secretNames }}:
        "${{ name }}" : "$(${{ name }})"
